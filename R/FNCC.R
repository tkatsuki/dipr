#' An FNCC Function
#'
#' These functions perform template matching using SAD (Sum of absolute differences), NCC (Normalized cross correlation), or FNCC (fast normalized cross correlation).
#'
#' @param a A target image of Image object or an array.
#' @param b A template image of Image object or an array.
#' @keywords Template matching
#' @return Returns a grayscale image.
#' @export
#' @examples
#' demo(TemplateMatchingDemo)

FNCC <- function(a,b){
  a <- a - sum(a)/length(a)
  b <- b - sum(b)/length(b)
  w <- ncol(a) + ncol(b) - 1
  h <- nrow(a) + nrow(b) - 1
  amat <- matrix(0, nrow=h, ncol=w)
  bmat <- matrix(0, nrow=h, ncol=w)
  amat[1:nrow(a), 1:ncol(a)] <- a
  bmat[1:nrow(b), 1:ncol(b)] <- b
  fa <- .fft2d(amat)
  fb <- .fft2d(bmat, TRUE)
  abs(.fft2d(fa*fb, TRUE))/(h*w)
}
